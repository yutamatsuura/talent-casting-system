# タレントキャスティングシステム - ワーカー説明資料

## 📌 この資料について
外部開発者（ワーカー）への口頭説明用にまとめた内容です。
実際の説明時にこの流れで話すとスムーズです。

---

# 1. プロジェクト概要（最初に話す）

## 「何を作るのか」を一言で
```
企業がフォームに情報を入力すると、
AIが最適なタレント30名をマッチングスコア付きで提案するシステムです。
```

## ビジネス背景（簡潔に）
- クライアント：キャスティング会社（25年の実績）
- 目的：タレント選定の効率化・データドリブン化
- 従来：担当者の経験と勘で選定 → 今後：データに基づく客観的な選定

---

# 2. ユーザーフロー（画面イメージを共有しながら）

## フォーム入力の流れ
```
Q2. 業種を選択（20業種から1つ）
    ↓
Q3. ターゲット層を選択（8区分から1つ）
    ↓
Q4. 予算を選択（4区分から1つ）
    ↓
Q5. 顧客情報入力（会社名、担当者名、メール等）
    ↓
【送信】
    ↓
★ 結果画面：マッチするタレント上位30名を表示
```

## 入力項目の詳細

### 業種（20種類）
食品 / 菓子・氷菓 / 乳製品 / 清涼飲料水 / アルコール飲料 / 
フードサービス / 医薬品・医療・健康食品 / 化粧品・ヘアケア・オーラルケア / 
トイレタリー / 自動車関連 / 家電 / 通信・IT / 
ゲーム・エンターテイメント・アプリ / 流通・通販 / ファッション / 
貴金属 / 金融・不動産 / エネルギー・輸送・交通 / 教育・出版・公共団体 / 観光

### ターゲット層（8区分）
男性12-19 / 女性12-19 / 男性20-34 / 女性20-34 / 
男性35-49 / 女性35-49 / 男性50-69 / 女性50-69

### 予算（4区分）
1,000万円未満 / 1,000万円〜3,000万円未満 / 
3,000万円〜1億円未満 / 1億円以上

---

# 3. マッチングロジック（★重要：しっかり説明）

## 全体の流れ
```
STEP 0: 予算でタレントを絞り込む
    ↓
STEP 1: 基礎パワー得点を算出
    ↓
STEP 2: 業種イメージ査定で加点・減点
    ↓
STEP 3: 基礎反映得点を算出（STEP1 + STEP2）
    ↓
STEP 4: 得点順に並べて上位30名を抽出
    ↓
STEP 5: 順位帯別にマッチングスコアを振り分け
    ↓
【結果】上位30名をスコア順で表示
```

## 各STEPの詳細説明

### STEP 0: 予算フィルタリング
```
処理内容：
- ユーザーが選んだ予算の上限以下のタレントだけを抽出
- 例：予算「1,000万円〜3,000万円」→ 契約金額3,000万円以下のタレント

使用データ：
- talents.money_max_one_year（タレントの年間契約金額上限）
```

### STEP 1: 基礎パワー得点
```
計算式：
基礎パワー得点 = (VR人気度 + TPRパワースコア) / 2

ポイント：
- VR人気度、TPRスコアは「ターゲット層別」に存在
- ユーザーが選んだターゲット層のデータを使用
- 例：「女性20-34」を選んだ → 女性20-34向けのVR/TPRデータを参照

使用データ：
- talent_scores.vr_popularity
- talent_scores.tpr_power_score
- talent_scores.target_segment_id（ターゲット層で絞り込み）
```

### STEP 2: 業種イメージ査定（★ここが複雑）
```
処理の流れ：
① 選択された業種の「求められるイメージ」を特定
   例：化粧品 → 「清潔感がある」
   例：自動車 → 「カッコいい」
   
② そのイメージ項目で、全タレント中の順位（%）を算出
   例：タレントAの「清潔感」スコアは上位10%

③ 順位に応じて加点・減点
   ┌─────────────┬────────┐
   │ 順位帯       │ 加減点 │
   ├─────────────┼────────┤
   │ 上位15%     │ +12点  │
   │ 16〜30%     │ +6点   │
   │ 31〜50%     │ +3点   │
   │ 51〜70%     │ -3点   │
   │ 71〜85%     │ -6点   │
   │ 86〜100%    │ -12点  │
   └─────────────┴────────┘

使用データ：
- industries.required_image_id（業種→イメージの紐付け）
- talent_images.image_xxx（7種類のイメージスコア）
```

### STEP 3: 基礎反映得点
```
計算式：
基礎反映得点 = 基礎パワー得点（STEP1） + 業種イメージ査定点（STEP2）

例：
- 基礎パワー得点：45点
- 業種イメージ査定：+12点（上位15%だったので）
- 基礎反映得点：57点
```

### STEP 4: ランキング確定
```
処理内容：
- 基礎反映得点で降順ソート
- 上位30名を抽出

※この時点で「誰が1位〜30位か」が確定
```

### STEP 5: マッチングスコア振り分け
```
処理内容：
- 順位帯ごとに決められた範囲内でランダムにスコアを付与
- ユーザーには「マッチングスコア」として表示

┌─────────────┬─────────────────┐
│ 順位帯      │ スコア範囲      │
├─────────────┼─────────────────┤
│ 1〜3位      │ 99.7 〜 97.0    │
│ 4〜10位     │ 96.9 〜 93.0    │
│ 11〜20位    │ 92.9 〜 89.0    │
│ 21〜30位    │ 88.9 〜 86.0    │
└─────────────┴─────────────────┘

例：3位のタレント → 97.0〜99.7の間でランダム → 98.2点
```

---

# 4. データベース構成

## テーブル一覧（全7テーブル）
```
【データテーブル】3つ
├── talents          : タレント基本情報（約2,000件）
├── talent_scores    : VR人気度・TPRスコア（約16,000件）
└── talent_images    : イメージスコア7項目（約16,000件）

【マスタテーブル】4つ
├── industries       : 業種マスタ（20件）
├── target_segments  : ターゲット層マスタ（8件）
├── budget_ranges    : 予算区分マスタ（4件）
└── image_items      : イメージ項目マスタ（7件）
```

## 各テーブルの役割

### talents（タレント基本情報）
```
主なカラム：
- account_id      : タレントの一意ID（主キー）
- name_full       : タレント名（VR/TPRデータとの照合に使用）
- gender          : 性別
- money_min/max_one_year : 年間契約金額の範囲

データソース：Nowデータ（クライアント提供のCSV）
```

### talent_scores（スコア）
```
主なカラム：
- account_id        : タレントID（外部キー）
- target_segment_id : ターゲット層ID（1〜8）
- vr_popularity     : VR人気度
- tpr_power_score   : TPRパワースコア
- base_power_score  : 基礎パワー得点（計算済み）

ポイント：
- 1タレントにつき、ターゲット層別に最大8レコード
- 例：タレントAの「男性20-34」向けスコア、「女性35-49」向けスコア...

データソース：VRデータ（C列）、TPRデータ（G列）
```

### talent_images（イメージスコア）
```
主なカラム：
- account_id        : タレントID（外部キー）
- target_segment_id : ターゲット層ID
- image_funny       : おもしろい
- image_clean       : 清潔感がある
- image_unique      : 個性的な
- image_trustworthy : 信頼できる
- image_cute        : かわいい
- image_cool        : カッコいい
- image_mature      : 大人の魅力がある

データソース：VRデータ（E〜K列）
```

### industries（業種マスタ）
```
主なカラム：
- industry_id       : 業種ID
- industry_name     : 業種名
- required_image_id : 求められるイメージ項目ID

例：
| ID | 業種名   | 求められるイメージ |
|----|----------|-------------------|
| 1  | 食品     | 信頼できる (4)    |
| 8  | 化粧品   | 清潔感がある (2)  |
| 10 | 自動車   | カッコいい (6)    |
```

---

# 5. 開発上のポイント（★重要）

## データの紐付け方法
```
VR/TPRデータ ←→ talentsテーブル の紐付け：
- VR/TPRのタレント名 と talents.name_full を文字列照合
- スペース（全角・半角）は除去して比較
- 照合できないタレントはログ出力（手動確認）
```

## ターゲット層の判定
```
VR/TPRファイル名からターゲット層を判定：
- 「男性12_19」→ target_segment_id = 1
- 「女性20_34」→ target_segment_id = 4
- ファイル名のパターンマッチで自動判定
```

## パーセンタイル（順位%）の算出
```
STEP2の業種イメージ査定で必要：
- 方式A：事前にバッチ処理で計算してDBに保存
- 方式B：リアルタイムで都度計算

推奨：方式A（レスポンス速度のため）
```

## レスポンス速度
```
目標：フォーム送信から結果表示まで3秒以内
- talent_scoresにbase_power_scoreを事前計算して保存
- 複雑なJOINは避け、必要に応じてインデックス追加
```

---

# 6. 質疑応答で想定される質問

## Q. イメージスコアの順位は全タレント中？同じターゲット層内？
```
A. 同じターゲット層内での順位です。
   例：「女性20-34」を選んだ場合、
   「女性20-34」のデータを持つタレント内での順位を算出。
```

## Q. VR/TPRデータがないタレントはどうなる？
```
A. マッチング対象外となります。
   - VRデータなし → vr_popularity = NULL → 基礎パワー得点算出不可
   - 該当ターゲット層のデータがない → 対象外
```

## Q. 同じ基礎反映得点のタレントがいたら？
```
A. 同点の場合は、base_power_score（STEP1の得点）で二次ソート。
   それでも同点なら、タレントID順。
```

## Q. 業種とイメージの紐付けは固定？
```
A. 現時点では固定（industriesテーブルで管理）。
   将来的に管理画面から変更可能にする可能性あり。
```

---

# 7. 説明の締め方

## 開発スコープの確認
```
今回の開発範囲：
✓ フォーム画面（入力〜送信）
✓ マッチングロジック（STEP 0〜5）
✓ 結果表示画面（上位30名リスト）
✓ DBテーブル作成・データ取込み

今回の範囲外：
× 管理画面
× 顧客情報のCRM連携
× タレント詳細画面
```

## 成果物の確認
```
納品物：
1. ソースコード一式
2. DBテーブル作成SQL
3. データ取込みバッチ処理
4. 簡易テスト結果レポート
```

## 次のステップ
```
1. この説明内容で不明点があれば質問してください
2. 開発環境の準備（Laravel + MySQL想定）
3. まずDBテーブル作成から着手
4. 週次で進捗MTG実施
```

---

# 📎 参考資料（説明時に画面共有）

- タレント選定_DB設計_フォーム対応版.xlsx
- タレント選定ロジック_クライアント確認用_簡潔版.xlsx
- 実際のVR/TPRデータサンプル（3件程度）
